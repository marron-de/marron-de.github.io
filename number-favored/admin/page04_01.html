<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>04_매출관리 01_매출현황</title>

    <!-- datepicker -->
    <link type="text/css" href="css/jquery-ui.css" rel="stylesheet" />
    <script type="text/javascript" src="js/jquery.min.js">
    </script>
    <script type="text/javascript" src="js/jquery-ui.min.js">
    </script>

    <!-- Swiper -->
    <link rel="stylesheet" href="css/swiper-bundle.min.css" />
    <script src="js/swiper-bundle.min.js"></script>

    <!-- chart.js -->
    <script src="js/chart.js"></script>
    <script src="js/chartjs-plugin-datalabels.js"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/style.css">

    <!-- Font -->
    <link href="css/Pretendard.css">

</head>

<body>


    <div class="wrap layout salesManagement_wrap">

        <!-- 04_매출관리 01_매출현황 -->
        <!-- navigation -->
        <div class="navigation">
            <div class="logo_box">
                <img src="img/logo_w.png" alt="" class="logo">
                <p class="txt">Super Admin</p>
            </div>
            <ul class="nav accordion">
                <li>
                    <div class="acc_tit">
                        <span class="icon"><img src="img/ico_nav1.png" alt=""></span>
                        <span class="title">대시보드</span>
                        <span class="arrow"></span>
                    </div>
                    <ul class="sub_nav">
                        <li>
                            <a href="page02_01.html" class="link">기본 통계</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <div class="acc_tit">
                        <span class="icon"><img src="img/ico_nav2.png" alt=""></span>
                        <span class="title">회원정보</span>
                        <span class="arrow"></span>
                    </div>
                    <ul class="sub_nav">
                        <li>
                            <a href="page03_01.html" class="link">회원 목록</a>
                        </li>
                        <li>
                            <a href="page03_02_01.html" class="link">회원 현황</a>
                        </li>
                    </ul>
                </li>
                <li class="show">
                    <div class="acc_tit">
                        <span class="icon"><img src="img/ico_nav3.png" alt=""></span>
                        <span class="title">매출관리</span>
                        <span class="arrow"></span>
                    </div>
                    <ul class="sub_nav" style="display: block;">
                        <li>
                            <a href="page04_01.html" class="link on">매출현황</a>
                        </li>
                        <li>
                            <a href="page04_02_01.html" class="link">결제내역</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <div class="acc_tit">
                        <span class="icon"><img src="img/ico_nav4.png" alt=""></span>
                        <span class="title">접속통계</span>
                        <span class="arrow"></span>
                    </div>
                    <ul class="sub_nav">
                        <li>
                            <a href="page05_01.html" class="link">트래픽 분석</a>
                        </li>
                        <li>
                            <a href="page05_02.html" class="link">접속환경 분석</a>
                        </li>
                    </ul>
                </li>
                <li class="line"></li>
                <li>
                    <div class="acc_tit">
                        <span class="icon"><img src="img/ico_nav5.png" alt=""></span>
                        <span class="title">설정</span>
                        <span class="arrow"></span>
                    </div>
                    <ul class="sub_nav">
                        <li>
                            <a href="page06_01_01.html" class="link">번호입력</a>
                        </li>
                    </ul>
                </li>
            </ul>
            <div class="btn_box">
                <button type="button" class="btn full">로그아웃</button>
            </div>
            <button type="button" class="nav_btn"></button>
        </div>

        <!-- container -->
        <div class="container">

            <p class="page_title">매출현황</p>

            <section class="section sec1">
                <div class="sec_titbox">
                    <div class="leftbox">
                        <p class="tit">매출현황</p>
                    </div>
                    <div class="rightbox"></div>
                </div>
                <div class="card_box">
                    <div class="card">
                        <div class="tit_box">
                            <img src="img/ico_total.png" alt="" class="icon">
                            <span class="txt">총 매출</span>
                        </div>
                        <div class="desc_box">
                            <div class="item">
                                <p class="tit">이번 달</p>
                                <p class="desc">                                    
                                    <span class="word">
                                        <span class="num">200,000</span>원
                                    </span>
                                </p>
                            </div>
                            <div class="item">
                                <p class="tit">오늘</p>
                                <p class="desc point">
                                    <span class="word">
                                        <span class="num">200,000</span>원
                                    </span>
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="tit_box">
                            <img src="img/ico_apple.png" alt="" class="icon">
                            <span class="txt">애플앱 매출</span>
                        </div>
                        <div class="desc_box">
                            <div class="item">
                                <p class="tit">이번 달</p>
                                <p class="desc">                                    
                                    <span class="word">
                                        <span class="num">200,000</span>원
                                    </span>
                                </p>
                            </div>
                            <div class="item">
                                <p class="tit">오늘</p>
                                <p class="desc point">
                                    <span class="word">
                                        <span class="num">200,000</span>원
                                    </span>
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="tit_box">
                            <img src="img/ico_goole.png" alt="" class="icon">
                            <span class="txt">구글앱 매출</span>
                        </div>
                        <div class="desc_box">
                            <div class="item">
                                <p class="tit">이번 달</p>
                                <p class="desc">                                    
                                    <span class="word">
                                        <span class="num">200,000</span>원
                                    </span>
                                </p>
                            </div>
                            <div class="item">
                                <p class="tit">오늘</p>
                                <p class="desc point">
                                    <span class="word">
                                        <span class="num">200,000</span>원
                                    </span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="section sec2">
                <div class="sec_titbox">
                    <div class="leftbox">
                        <p class="tit">Plan별 매출</p>
                    </div>
                    <div class="rightbox">
                        <div class="sales_info">
                            이번달 <span class="month">10개</span>
                            / 오늘 <span class="today">10개</span>
                        </div>
                    </div>
                </div>
                <div class="card_box">
                    <div class="card">
                        <div class="tit_box">
                            <img src="img/ico_p.png" alt="" class="icon">
                            <span class="txt">Premium</span>
                        </div>
                        <div class="desc_box">
                            <div class="item">
                                <p class="tit">이번 달</p>
                                <p class="desc">
                                    <span class="word">
                                        <span class="num">10</span>개
                                    </span>
                                    <span class="word">
                                        <span class="num">200,000</span>원
                                    </span>
                                </p>
                            </div>
                            <div class="item">
                                <p class="tit">오늘</p>
                                <p class="desc point">
                                    <span class="word">
                                        <span class="num">10</span>개
                                    </span>
                                    <span class="word">
                                        <span class="num">200,000</span>원
                                    </span>
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="tit_box">
                            <img src="img/ico_b.png" alt="" class="icon">
                            <span class="txt">Basic</span>
                        </div>
                        <div class="desc_box">
                            <div class="item">
                                <p class="tit">이번 달</p>
                                <p class="desc">
                                    <span class="word">
                                        <span class="num">10</span>개
                                    </span>
                                    <span class="word">
                                        <span class="num">200,000</span>원
                                    </span>
                                </p>
                            </div>
                            <div class="item">
                                <p class="tit">오늘</p>
                                <p class="desc point">
                                    <span class="word">
                                        <span class="num">10</span>개
                                    </span>
                                    <span class="word">
                                        <span class="num">200,000</span>원
                                    </span>
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="tit_box">
                            <img src="img/ico_f.png" alt="" class="icon">
                            <span class="txt">Free</span>
                        </div>
                        <div class="desc_box">
                            <div class="item">
                                <p class="tit">이번 달</p>
                                <p class="desc">
                                    <span class="word">
                                        <span class="num">10</span>개
                                    </span>
                                    <span class="word">
                                        <span class="num">-</span>원
                                    </span>
                                </p>
                            </div>
                            <div class="item">
                                <p class="tit">오늘</p>
                                <p class="desc point">
                                    <span class="word">
                                        <span class="num">10</span>개
                                    </span>
                                    <span class="word">
                                        <span class="num">-</span>원
                                    </span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="section sec3">
                <div class="sec_titbox">
                    <div class="leftbox">
                        <p class="tit">결제건수 ˑ 매출 추이</p>
                    </div>
                    <div class="rightbox">
                        <div class="filter_box">
                            <button type="button" id="chart1_daybtn" class="filter_btn day on">일별</button>
                            <button type="button" id="chart1_monthbtn" class="filter_btn month">월별</button>
                        </div>
                    </div>
                </div>
                <div class="chart_box">
                    <div class="chart_top">
                        <div class="select_box">
                            <select class="select">
                                <option value="">8월</option>
                                <option value="">9월</option>
                                <option value="">10월</option>
                                <option value="">11월</option>
                                <option value="">12월</option>
                            </select>
                        </div>
                        <div class="input_box date">
                            <input type="text" placeholder="날짜 선택" class="input_text datepicker" readonly
                                value="2024-08-01 ~ 2024-08-07">
                        </div>
                    </div>
                    <div class="chart">
                        <canvas id="chart1" width="1432" height="400"></canvas>
                    </div>
                </div>
            </section>

        </div>

    </div>



    <!-- JS -->
    <!-- <script src="js/jquery-3.4.1.min.js"></script> -->
    <script src="js/common.js"></script>
    <script>
        const dayLabels = ['2024-11-03 일요일', '2024-11-04 월요일', '2024-11-05 화요일', '2024-11-06 수요일', '2024-11-07 목요일',
            '2024-11-08 금요일', '2024-11-09 토요일'
        ];
        const monthLabels = ['2024-06', '2024-07', '2024-08', '2024-09', '2024-10', '2024-11', '2024-12'];
        const salesData = [70000, 80000, 90000, 100000, 100000, 90000, 80000];
        const minValue = Math.min(...salesData);
        const maxValue = Math.max(...salesData);
        const stepCount = (maxValue - minValue) / 10000 + 1
        let stepSize;
        if (stepCount > 6) {
            stepSize = Math.ceil((maxValue - minValue) / 5 / 10000) * 10000;
        } else {
            stepSize = 10000;
        }
        const rangeCount = Math.ceil((maxValue - minValue) / stepSize + 1);

        function createGradient(context, colorStart, colorEnd) {
            const chart = context.chart;
            const ctx = chart.ctx;
            const yValue = context.raw;
            const y2Position = chart.scales.y2.getPixelForValue(yValue);

            if (isNaN(y2Position) || y2Position === Infinity || y2Position === -Infinity) {
                return colorStart;
            }

            const gradient = ctx.createLinearGradient(0, y2Position, 0, chart.scales.y2.getPixelForValue(0));
            gradient.addColorStop(0, colorStart);
            gradient.addColorStop(1, colorEnd);
            return gradient;
        }
        const config1 = {
            type: 'line',
            data: {
                labels: dayLabels,
                datasets: [{
                        label: '매출',
                        data: salesData,
                        borderColor: '#008ee8',
                        borderWidth: 3.5,
                        pointBackgroundColor: '#fff',
                        pointRadius: 6,
                        pointBorderWidth: 3.5,
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#008ee8',
                        pointHoverRadius: 8,
                        pointHoverBorderWidth: 3.5,
                        type: 'line',
                        yAxisID: 'y',
                        order: 0
                    },
                    {
                        label: '결제 건수',
                        data: [3, 3, 3, 4.5, 4.5, 4.5, 4.5],
                        backgroundColor: function (context) {
                            return createGradient(context, '#9750F8', '#3E1AD6');
                        },
                        borderRadius: 8,
                        barThickness: 24,
                        type: 'bar',
                        yAxisID: 'y2',
                        order: 1,

                    }
                ]
            },
            options: {
                plugins: {
                    legend: {
                        display: false,
                    },
                    tooltip: {
                        enabled: true,
                    }
                },
                responsive: false,
                layout: {
                    padding: {
                        top: 0,
                        left: -18,
                        right: 0,
                        bottom: 0,
                    }
                },
                scales: {
                    x: {
                        offset: true,
                        ticks: {
                            padding: 12,
                            font: {
                                family: 'Pretendard',
                                weight: '400',
                                size: 13,
                                color: '#40395d',
                            },
                        },
                        grid: {
                            display: false,
                        },
                    },
                    y: {
                        beginAtZero: false,
                        position: 'left',
                        ticks: {
                            stepSize: stepSize,
                            padding: 18,
                            font: {
                                family: 'Pretendard',
                                weight: '400',
                                size: 13,
                                color: '#383b40',
                            },
                            callback: function (value) {
                                if (minValue - stepSize * 3 >= 0 && minValue - stepSize * 2 >= 0 && minValue -
                                    stepSize >= 0) {
                                    if (rangeCount === 4 && value === minValue - stepSize * 2) {
                                        return '0';
                                    } else if (rangeCount <= 3 && rangeCount > 6 && value === minValue -
                                        stepSize * 3) {
                                        return '0';
                                    }
                                }
                                return value;
                            },
                        },
                        min: (function () {
                            if (minValue - stepSize * 3 > 0 && minValue - stepSize * 2 > 0 && minValue -
                                stepSize > 0) {
                                if (rangeCount === 6) {
                                    return;
                                } else if (rangeCount === 5) {
                                    return minValue - stepSize;
                                } else if (rangeCount === 4) {
                                    return minValue - stepSize * 2;
                                } else if (rangeCount === 3 || rangeCount === 2 || stepCount === 1) {
                                    return minValue - stepSize * 3;
                                }
                            } else {
                                return 0;
                            }
                        })(),
                        max: (function () {
                            if (minValue - stepSize * 3 > 0 && minValue - stepSize * 2 > 0 && minValue -
                                stepSize > 0) {
                                if (rangeCount === 2) {
                                    return maxValue + stepSize;
                                } else if (rangeCount === 1) {
                                    return maxValue + stepSize * 2;
                                } else {
                                    return;
                                }
                            } else {
                                if (rangeCount === 3) {
                                    return maxValue + stepSize * 1;
                                } else if (rangeCount === 2) {
                                    return maxValue + stepSize * 2;
                                } else if (rangeCount === 1) {
                                    return maxValue + stepSize * 3;
                                } else {
                                    return;
                                }
                            }
                        })(),
                        border: {
                            display: false,
                        },
                    },
                    y2: {
                        beginAtZero: true,
                        position: 'right',
                        ticks: {
                            stepSize: 1,
                            padding: 18,
                            font: {
                                family: 'Pretendard',
                                weight: '400',
                                size: 13,
                                color: '#383b40',
                            },
                            autoSkip: true,
                        },
                        border: {
                            display: false,
                        },
                    },
                },
            },
        };
        const chart1 = document.getElementById('chart1').getContext('2d');
        const chartBox1 = new Chart(chart1, config1);

        // 일간 버튼 클릭 시 데이터 및 범위 업데이트
        document.getElementById('chart1_daybtn').addEventListener('click', () => {
            chartBox1.data.datasets[0].data = [70000, 80000, 90000, 100000, 100000, 90000, 80000];
            chartBox1.data.datasets[1].data = [3, 3, 3, 4.5, 4.5, 4.5, 4.5];
            chartBox1.data.labels = dayLabels;
            chartBox1.update();
        });

        // 월간 버튼 클릭 시 데이터 및 범위 업데이트
        document.getElementById('chart1_monthbtn').addEventListener('click', () => {
            chartBox1.data.datasets[0].data = [80000, 70000, 70000, 100000, 90000, 100000, 70000];
            chartBox1.data.datasets[1].data = [2, 2, 5, 3, 3, 2, 2];
            chartBox1.data.labels = monthLabels;
            chartBox1.update();
        });
    </script>




</body>

</html>